
# Geospatial mapping

#### This folder contains scripts that are used for training random forest machine learning models.


- The script named ['grsearch_rmf.rmd'](https://github.com/haozhima95/Global_mapping_root_shoot_ratio/blob/d0fc1a46e66053ce9392f6e232c3dd770f51731a/RSR_Geospatial_Modeling/Mapping%20and%20modelling/grsearch_rmf.Rmd) contains the script that can be run for grid-searching approach. This approach allows users to get the best models with combinations of hyperparamters. 

- The file named ['forest_rfgrsearch_r2_20200517.csv'](https://github.com/haozhima95/Global_mapping_root_shoot_ratio/blob/d0fc1a46e66053ce9392f6e232c3dd770f51731a/RSR_Geospatial_Modeling/Mapping%20and%20modelling/forest_rfgrsearch_r2_20200517.csv), ['grass_rfgrsearch_r2_20200517.csv'](https://github.com/haozhima95/Global_mapping_root_shoot_ratio/blob/d0fc1a46e66053ce9392f6e232c3dd770f51731a/RSR_Geospatial_Modeling/Mapping%20and%20modelling/grass_rfgrsearch_r2_20200517.csv) and ['grass_rfgrsearch_r2_20200517.csv'](https://github.com/haozhima95/Global_mapping_root_shoot_ratio/blob/d0fc1a46e66053ce9392f6e232c3dd770f51731a/RSR_Geospatial_Modeling/Mapping%20and%20modelling/shrub_rfgrsearch_r2_20200517.csv) contains the grid-search results from the file ['grsearch_rmf.Rmd'](https://github.com/haozhima95/Global_mapping_root_shoot_ratio/blob/d0fc1a46e66053ce9392f6e232c3dd770f51731a/RSR_Geospatial_Modeling/Mapping%20and%20modelling/grsearch_rmf.Rmd).

- The file named ['forest_rf_grsearch.js'](https://github.com/haozhima95/Global_mapping_root_shoot_ratio/blob/d0fc1a46e66053ce9392f6e232c3dd770f51731a/RSR_Geospatial_Modeling/Mapping%20and%20modelling/forest_rf_grsearch.js), ['grass_rf_grsearch.js'](https://github.com/haozhima95/Global_mapping_root_shoot_ratio/blob/d0fc1a46e66053ce9392f6e232c3dd770f51731a/RSR_Geospatial_Modeling/Mapping%20and%20modelling/grass_rf_grsearch.js) and ['shrub_rf_grsearch.js'](https://github.com/haozhima95/Global_mapping_root_shoot_ratio/blob/d0fc1a46e66053ce9392f6e232c3dd770f51731a/RSR_Geospatial_Modeling/Mapping%20and%20modelling/shrub_rf_grsearch.js) shall be run in Google Earth Engine to get the maps from the best ten models in each vegetation type.

- The file named ['rmf_aggregate_summary.js'](https://github.com/haozhima95/Global_mapping_root_shoot_ratio/blob/d0fc1a46e66053ce9392f6e232c3dd770f51731a/RSR_Geospatial_Modeling/Mapping%20and%20modelling/rmf_aggregate_summary.js) can be run in Google Earth Engine to summarize the layers you produced via ['forest_rf_grsearch.js'](https://github.com/haozhima95/Global_mapping_root_shoot_ratio/blob/d0fc1a46e66053ce9392f6e232c3dd770f51731a/RSR_Geospatial_Modeling/Mapping%20and%20modelling/forest_rf_grsearch.js), ['grass_rf_grsearch.js'](https://github.com/haozhima95/Global_mapping_root_shoot_ratio/blob/d0fc1a46e66053ce9392f6e232c3dd770f51731a/RSR_Geospatial_Modeling/Mapping%20and%20modelling/grass_rf_grsearch.js) and ['shrub_rf_grsearch.js'](https://github.com/haozhima95/Global_mapping_root_shoot_ratio/blob/d0fc1a46e66053ce9392f6e232c3dd770f51731a/RSR_Geospatial_Modeling/Mapping%20and%20modelling/shrub_rf_grsearch.js) files. Thus you'll get a summarized mean, std, min and max layer for each vegetation type.

- The file named ['BlockedLeaveOneOut.ipynb'](https://github.com/haozhima95/Global_mapping_root_shoot_ratio/blob/d0fc1a46e66053ce9392f6e232c3dd770f51731a/RSR_Geospatial_Modeling/Mapping%20and%20modelling/BlockedLeaveOneOut.ipynb) is used for spatial cross validation, which is a way to check the effect of spatial autocorrelation on model predictive power. The basic idea is to filter out all but one point within the bufferzone. The point remains in the buffer zone is regarded as testing data whereas the points falling out of the buffer zone are used as training data. Iterating through all the sample points, we are able to get the raw data and the predictive data for each sample point. We created semivariograms to check if spaital autocorrelaion influences our model results via the script 'semivariograms.Rmd'. This script can also be used to construct Extended Data Fig. 2.

- The script named ['modelprediction.Rmd'](https://github.com/haozhima95/Global_mapping_root_shoot_ratio/blob/d0fc1a46e66053ce9392f6e232c3dd770f51731a/RSR_Geospatial_Modeling/Mapping%20and%20modelling/modelprediction.Rmd) can be used to construt Fig 2 and Extended Data Fig. 2.

- To evaluate the model uncertainty, we use the script ['rsr_total_coverage_interpolation.js'](https://github.com/haozhima95/Global_mapping_root_shoot_ratio/blob/d0fc1a46e66053ce9392f6e232c3dd770f51731a/RSR_Geospatial_Modeling/Mapping%20and%20modelling/rsr_total_coverage_interpolation.js) to assess the coverage of sampling points on environmental covariates. Using a principal component analysis on the matrix of predictor value and using PCA axes to generate the convex-hull, we create a evaluation of predictor coverage by taking interactions betweeen predictors into account. This analysis is shown in ['PCA_ConvexHull_IntExt_Code.ipynb'](https://github.com/haozhima95/Global_mapping_root_shoot_ratio/blob/d0fc1a46e66053ce9392f6e232c3dd770f51731a/RSR_Geospatial_Modeling/Mapping%20and%20modelling/PCA_ConvexHull_IntExt_Code.ipynb). 

 - Bootstrapping analyses are applied in the three vegetation types using the selected best random forest model. The scripts are ['forest_rmf_bootstrap.js'](https://github.com/haozhima95/Global_mapping_root_shoot_ratio/blob/d0fc1a46e66053ce9392f6e232c3dd770f51731a/RSR_Geospatial_Modeling/Mapping%20and%20modelling/forest_rmf_bootstrap.js),['grass_rmf_bootstrap.js'](https://github.com/haozhima95/Global_mapping_root_shoot_ratio/blob/d0fc1a46e66053ce9392f6e232c3dd770f51731a/RSR_Geospatial_Modeling/Mapping%20and%20modelling/grass_rmf_bootstrap.js) and ['shrub_rmf_bootstrap.js'](https://github.com/haozhima95/Global_mapping_root_shoot_ratio/blob/d0fc1a46e66053ce9392f6e232c3dd770f51731a/RSR_Geospatial_Modeling/Mapping%20and%20modelling/shrub_rmf_bootstrap.js). The scripts are run in Google Earth Engine.
